---
title: 05.開発環境構築
source:
author:
  -
published:
created: 2026-01-19
description:
tags:
---
## 前提

- 本リポジトリは **pnpm** を利用する（`docs/03.設計書.md` の「開発プロセス／開発方針」を参照）
- 秘匿情報（APIキー等）は **絶対にハードコードしない／コミットしない**
  - ローカル用の環境変数は `.env.local` を利用する（gitignore前提）

## 初回セットアップ

- 依存関係のインストール
	- `pnpm install`
- 開発サーバー起動
	- `pnpm dev`
- テスト実行
	- `pnpm test`

## スタブモード（ローカル開発の推奨）

日常の開発では、認証・CRUDが未完成でも UI/ロジックを先に進めるため、スタブを利用する。

- スタブ有効化（例）
	- `NEXT_PUBLIC_USE_STUB_AUTH=true`
	- `NEXT_PUBLIC_USE_STUB_POSTS=true`
- 注意
	- 本番環境（`NODE_ENV=production`）では上記が設定されていても **スタブが有効にならない**ガードを前提とする（詳細は `docs/03.設計書.md` を参照）

## 開発用コマンド（ローカルDB）

- ローカルDB(PostgresQL)起動
	- brew services start postgresql@17
- ローカルDB終了
	- brew services stop postgresql@17
- ローカルDBの起動状況確認
	- brew services list

## 環境変数（メモ）

- `.env` / `.env.local` の方針は `docs/03.設計書.md` を参照
- DB接続を行う場合のキー例
	- `DATABASE_URL`
	- `DATABASE_DIRECT_URL`（マイグレーション用）

## Prisma / DB セットアップ（P2-DB-01）

- バージョン: Prisma 6 系（`prisma` / `@prisma/client` は **6.19.1** 固定）
- ローカルDB想定:
	- DB名例: `mono_log_dev`（開発用）、`mono_log_test`（テスト用）
	- `.env.local` 例（ローカルのみに置く。gitignore 対象）:
		- `DATABASE_URL="postgresql://<your_user>@localhost:5432/mono_log_dev?schema=public"`
		- `DATABASE_DIRECT_URL="postgresql://<your_user>@localhost:5432/mono_log_dev?schema=public"`
- 基本コマンド（ローカルのみ / 本番では実行しない）:
	- Prisma Client 生成: `pnpm exec prisma generate`
	- マイグレーション作成+適用: `pnpm db:migrate:dev --name <name>`
- stg/prod（Neon）への反映は CI で `prisma migrate deploy` を実行（適用のみ）。
  - Secrets/運用: `docs/07.運用手順（CI・デプロイ）.md`（※後日作成予定）
  - Vercel/Neon 初期セットアップ: `docs/vercel-neon-setup.md`（※後日作成予定）
