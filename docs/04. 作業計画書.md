---
title: 04. 作業計画書
source:
author:
  -
published:
created: 2025-11-25
description:
tags:
---
# 使い方（チェックリスト式）

- 仕様の正: `docs/05. 仕様書.md` / `docs/02. 要件定義書.md`（内部設計: `docs/03. 設計書.md`）
- 本書の目的: 作業順・依存関係（前提ID）・完了条件（DoD）を管理する
- 記法
	- `- [ ]` 未完了 / `- [x]` 完了
	- ID形式: `P{フェーズ}-{カテゴリ}-{連番}`（例: `P2-DB-01`, `P1-RSK-01`）
	- 前提: 依存するID（なければ `-`）
	- DoD: 完了条件（テスト条件は原則ここに含める）
- 進め方
	- フェーズ内の実行順は固定しない（前提IDが満たされたものから進める）
	- まずUI/レイアウトを固め、スタブ/モックでつなぎ、TDD（Red→Green→Refactor）で担保する

# フェーズ0（P0: 準備）

- [ ] `P0-BASE-01` 開発支援設定（AGENTS/IDE）
	- 前提: -
	- 参照: `../AGENTS.md`
	- DoD: `AGENTS.md` の指示が作業環境に反映されている（エージェント/IDE設定を含む）

# フェーズ1（P1: スタブモードでUI一通り）

## ゴール
- **スタブモードでUIの一通りの操作が確認できる状態**（Vercelデモ用デプロイ可能）

## 進め方
- 推奨の進行順は **未ログイン → タイムライン（ログイン中） → ゴミ箱 → 横断UI**。
- ただし実行順は固定ではなく、**前提ID（依存関係）を満たすことを最優先**とする。
- 仕様の正は `docs/05. 仕様書.md` / `docs/02. 要件定義書.md` とし、本書は作業順・完了条件（DoD）に集中する（内部設計は `docs/03. 設計書.md`）。

## チェックリスト

### P1-BASE（基盤）

- [ ] `P1-BASE-01` 開発環境構築
	- 前提: `P0-BASE-01`
	- 参照: `docs/01. 開発環境構築.md`, `docs/03. 設計書.md`「開発プロセス／開発方針」「採用技術・構成技術」
	- DoD: `pnpm dev` で起動できる
- [ ] `P1-BASE-02` テスト基盤（Jest + React Testing Library）
	- 前提: `P1-BASE-01`
	- 参照: `docs/03. 設計書.md`「テスト戦略（Jest, モック, スタブ）」>「テストレベル別のDB/スタブ方針」
	- DoD: `pnpm test` がGREEN
- [ ] `P1-BASE-03` UI基盤（TailwindCSS + shadcn/ui）
	- 前提: `P1-BASE-01`
	- 参照: `docs/05. 仕様書.md`「UI(shadcn/ui)」
	- DoD: `components/ui/*` はshadcn CLIで生成され、アプリ側が `@/components/ui/*` をインポートして利用している
- [ ] `P1-BASE-04` 外観（テーマ）基盤（next-themes）
	- 前提: `P1-BASE-03`
	- 参照: `docs/05. 仕様書.md`「外観（テーマ）設計（next-themes）」
	- DoD: ThemeProvider導入が完了し、切替UIなしでアプリ全体が破綻しない
- [ ] `P1-BASE-05` スタブ切替の接続ポイント（authAdapter / postRepository）
	- 前提: `P1-BASE-01`
	- 参照: `docs/03. 設計書.md`「スタブ／本番切り替え方針」「認証・データ処理アーキテクチャ概要」
	- DoD: 環境変数でスタブ/本番を切替でき、アプリコードは接続ポイント経由でのみアクセスしている
- [ ] `P1-BASE-06` 画面分岐（土台）
	- 前提: `P1-BASE-05`
	- 参照: `docs/03. 設計書.md`「セッション取得とUI更新方針」
	- DoD: Server Component で「未ログイン／ログイン中」を出し分けできる（フェーズ1はスタブセッションで可）

### P1-AUTH（認証: スタブ）

- [ ] `P1-AUTH-01` スタブ認証の導入（/api/auth/stub + Cookie）
	- 前提: `P1-BASE-05`
	- 参照: `docs/03. 設計書.md`「リスクと対策（認証スタブ）」「認証フロー設計」
	- DoD: ログイン/ログアウトの導線がスタブで成立し、ログイン状態に応じたUI分岐ができる
- [ ] `P1-RSK-01` 認証スタブ運用ガード
	- 前提: `P1-AUTH-01`
	- 参照: `docs/03. 設計書.md`「スタブ認証の運用ガード（P1-RSK-01）」
	- DoD:
		- 本番環境（`NODE_ENV=production`）で `/api/auth/stub` が 403
		- CI 環境（`NODE_ENV=test`）でスタブ認証が無効
		- 開発環境でのみスタブ認証が動作

### P1-HOME（未ログイン）

- [ ] `P1-HOME-01` 未ログイン画面（UI/文言/テスト）
	- 前提: `P1-BASE-03`
	- 参照: `docs/05. 仕様書.md`（ページレイアウト/ヘッダー/ログインボタン/Link/フッター）, `docs/06.テキスト・コンテンツ定義.md`
	- DoD: Header/Main/Footer とログインモーダルの開閉がテストでGREEN

### P1-TL（タイムライン: ログイン中）

- [ ] `P1-TL-01` ログイン中レイアウト（ヘッダー/メイン/フッター非表示）
	- 前提: `P1-AUTH-01`
	- 参照: `docs/05. 仕様書.md`「ページレイアウト（Miro準拠）」「コンポーネント: ヘッダー」
	- DoD: ログイン中UIの骨組みが表示できる
- [ ] `P1-TL-02` 表示切替（mode/view）とURL正規化
	- 前提: `P1-TL-01`
	- 参照: `docs/05. 仕様書.md`「コンポーネント: 表示切り替え」, `docs/03. 設計書.md`「URL正規化（canonical化）方針」
	- DoD: mode/viewの切替がURLに反映され、戻る/進むで復元できる
- [ ] `P1-TL-03` 投稿エディタ（スタブCRUDでOK）
	- 前提: `P1-BASE-05`
	- 参照: `docs/05. 仕様書.md`「コンポーネント: 投稿エディタ」
	- DoD: 保存/更新/未入力アラート/sonner通知がテストでGREEN
- [ ] `P1-TL-04` 投稿一覧（スタブでOK）
	- 前提: `P1-BASE-05`
	- 参照: `docs/05. 仕様書.md`「コンポーネント：投稿一覧」「コンポーネント: ローディング表示」
	- DoD: 初期ロード表示とSkeletonローディングが破綻しない
- [ ] `P1-TL-05` ソート（更新順/投稿順 × 昇順/降順）
	- 前提: `P1-TL-04`
	- 参照: `docs/05. 仕様書.md`「投稿ソート機能」
	- DoD: URLクエリによりソートが切り替わり、テストでGREEN
- [ ] `P1-TL-06` 無限スクロール（スタブ）
	- 前提: `P1-TL-04`
	- 参照: `docs/05. 仕様書.md`「無限スクロール」
	- DoD: IntersectionObserver で追加取得でき、レイアウトシフト防止を含めてテストでGREEN
- [ ] `P1-TL-07` ゴミ箱投入（スタブ）
	- 前提: `P1-TL-04`
	- 参照: `docs/05. 仕様書.md`「コンポーネント：投稿一覧 個別投稿」
	- DoD: ゴミ箱投入で一覧から消える挙動がテストでGREEN

### P1-TRASH（ゴミ箱）

- [ ] `P1-TRASH-01` ゴミ箱ビュー（表示/操作/テスト）
	- 前提: `P1-TL-02`, `P1-TL-07`
	- 参照: `docs/05. 仕様書.md`「コンポーネント: ゴミ箱」, `docs/06.テキスト・コンテンツ定義.md`
	- DoD: trashedのみ表示、選択UI、復元/削除/空にするがテストでGREEN

### P1-XCUT（横断UI・品質）

- [ ] `P1-XCUT-01` エラー通知・フィードバック（sonner）とシミュレーション
	- 前提: `P1-BASE-03`
	- 参照: `docs/03. 設計書.md`「エラー通知実装設計」
	- DoD: `?errorTest=...` が開発環境のみで動作し、本番では無効（テストでGREEN）
- [ ] `P1-XCUT-02` 多重実行防止（Mutation中のdisabled）
	- 前提: `P1-TL-03`, `P1-TRASH-01`
	- 参照: `docs/03. 設計書.md`「非同期処理の多重実行防止設計」
	- DoD: 主要操作の連打で二重実行しない（テストで担保）

# フェーズ2（P2: 本番接続・機能拡張）

## チェックリスト

- [ ] `P2-DB-01` DB接続（Prisma / Neon）
	- 前提: `P1-BASE-01`
	- 参照: `docs/03. 設計書.md`「インフラ構成／アーキテクチャ設計」「DBマイグレーション運用フロー（開発→本番）」
	- DoD: マイグレーション運用が回る（devで作成→CIでdeploy）
- [ ] `P2-AUTH-01` Auth.js 本番接続（Route Handlers）
	- 前提: `P2-DB-01`
	- 参照: `docs/03. 設計書.md`「認証フロー設計」
	- DoD: Google OAuthでログインでき、スタブCookieを撤去できる
- [ ] `P2-TL-01` 手動並び替え（上下ボタン/ドラッグ&ドロップ）＋永続化
	- 前提: `P2-DB-01`
	- 参照: `docs/05. 仕様書.md`「投稿並び替え機能（ドラッグ&ドロップ）【フェーズ2】」
	- DoD: 並び順がDBに保存され、再読込後も維持される
- [ ] `P2-TL-02` 無限スクロール（本番: Server Actions + Prisma + TanStack Query）
	- 前提: `P2-DB-01`
	- 参照: `docs/05. 仕様書.md`「無限スクロール」, `docs/03. 設計書.md`「投稿一覧取得・キャッシュ戦略（TanStack Query）」
	- DoD: スタブから本番実装に差し替えでき、UXが劣化しない
- [ ] `P2-ACCOUNT-01` アカウント削除
	- 前提: `P2-AUTH-01`
	- 参照: `docs/02. 要件定義書.md`
	- DoD: ユーザーデータ削除→セッション終了→完了通知まで成立する
- [ ] `P2-TAG-01` タグ（付与/編集/フィルタ/キャッシュ連携）
	- 前提: `P2-DB-01`
	- 参照: `docs/05. 仕様書.md`「タグ機能設計」
	- DoD: タグ保存と絞り込みが成立し、URL/キャッシュと整合する
- [ ] `P2-DIARY-01` 日記モード（ユーザー設定として永続化）
	- 前提: `P2-DB-01`
	- 参照: `docs/02. 要件定義書.md`, `docs/05. 仕様書.md`「コンポーネント: ユーザーアイコン」
	- DoD: トグルでON/OFFでき、日記ボタン/投稿モードが連動する
- [ ] `P2-TEST-01` テスト拡充（認証/DB/無限スクロール/ソート/タグ）
	- 前提: `P2-AUTH-01`, `P2-DB-01`
	- 参照: `docs/03. 設計書.md`「テスト戦略（Jest, モック, スタブ）」>「テストレベル別のDB/スタブ方針」
	- DoD: 重要フローの単体/結合テストが追加され、CIで安定してGREEN

# フェーズ3（P3: 外観）

- [ ] `P3-APP-01` 外観変更（system/light/dark、文字サイズ）
	- 前提: `P1-BASE-04`
	- 参照: `docs/05. 仕様書.md`「外観（テーマ）設計（next-themes）」
	- DoD: 切替UI＋永続化（User.fontScale + localStorage）＋回帰テストが完了

# フェーズ4（P4: 検索・整理）

- [ ] `P4-SEARCH-01` テキスト検索（タイトル/本文/モード/タグ）
	- 前提: `P2-DB-01`
	- 参照: `docs/02. 要件定義書.md`
	- DoD: 検索条件の保持/復元を含めて操作が成立する
- [ ] `P4-TAG-01` タグ機能の拡張（追加/編集/削除）
	- 前提: `P2-TAG-01`
	- 参照: `docs/02. 要件定義書.md`
	- DoD: タグ削除時の挙動（「タグ未登録」）が仕様通り
- [ ] `P4-LIFE-01` 投稿ライフサイクル管理（自動削除）
	- 前提: `P2-DB-01`
	- 参照: `docs/02. 要件定義書.md`
	- DoD: 一定日数経過後に自動削除でき、運用上の安全策がある
- [ ] `P4-EXPORT-01` 投稿エクスポート（検討）
	- 前提: `P2-DB-01`
	- 参照: `docs/02. 要件定義書.md`
	- DoD: エクスポート形式・操作・範囲が決まっている（ToDoを解消）

※ 各フェーズの詳細な画面仕様・要件は `docs/05. 仕様書.md` / `docs/02. 要件定義書.md`、内部構造・テスト方針は `docs/03. 設計書.md` を参照すること。
