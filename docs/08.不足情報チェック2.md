---
title: 08.不足情報チェック2（実装観点・残タスク）
source:
author:
  -
published:
created: 2026-01-29
description:
tags:
---

# 目的

`docs/01.要件定義書.md` → `docs/02.仕様書.md` → `docs/03.設計書.md` を突き合わせ、実装に必要だが **未決・不足・矛盾** している情報を棚卸しする。

補足:
- `docs/08.不足情報チェック.md` に記載の GAP（GAP-001〜GAP-020）は多くが **[済]** になっているため、本ファイルでは「現時点で残っている（または新たに見つかった）」論点のみを扱う。

# 対象

- 要件: `docs/01.要件定義書.md`
- 仕様: `docs/02.仕様書.md`
- 設計: `docs/03.設計書.md`

# 不足情報・矛盾一覧（優先度順）

| ID      | 修正状況  | 領域                                 | 参照（現状）                                                                                                               | 不足/矛盾                                                                                | 追記・修正の提案（決めること）                                                                                                                                      | 優先度        | メモ                       | 修正結果                                                                                                                                                                             |
| ------- | ----- | ---------------------------------- | -------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- | ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| GAP-021 | - [済] | ログイン（OAuth失敗時のモーダル挙動）              | 02: ログイン章「失敗/キャンセル→モーダルは閉じる」 / 02: エラーハンドリング「失敗→モーダルは開いたまま」 / 03: UI対応表「失敗/キャンセル→モーダルは閉じる」                           | **仕様書内で自己矛盾**（閉じる vs 開いたまま）。03 とも整合しない可能性。                                           | 02 を単一正に揃える（推奨: 03 に合わせて「閉じる」へ統一）。「再試行導線」を合わせて記載し、文言は 06 を正にする。                                                                                      | High       | 実装/テストに直結（状態遷移が分岐する）     | `docs/02.仕様書.md` の「ログイン」章と「エラーハンドリング」章を「失敗/キャンセル→モーダルは閉じる」で統一（文言は `docs/06` 参照に寄せた）。                                                                                             |
| GAP-022 | - [済] | CRUD のI/F（Server Actions vs 投稿API） | 03: CRUD=Server Actions + TanStack Query / 03（旧）: 「`NODE_ENV=production` では `/api/posts/**` を 403」等、投稿APIの存在を前提とした記述 | **実装入口が曖昧**（投稿の取得/更新/削除が Server Actions で完結なのか、Route Handler（`/api/posts/**`）を叩くのか）。 | どちらを採用するか明文化する。Route Handler を使うなら endpoint 一覧（method/path）と request/response（cursor含むDTO）を設計書に追記。使わないなら `/api/posts/**` が何を指すか注釈・章整理し、読み手が迷わない形にする。 | High       | 実装構造（データ取得/ガード/テスト）が変わる  | `docs/03.設計書.md` の「投稿APIの暫定ガード」を「投稿操作（Server Actions）の暫定ガード」に改め、通信I/Fは Server Actions を正と明記。`/api/posts/**` 前提の記述を削除し、ガードは Server Actions/Repository 側で 403 相当にする方針へ一本化。         |
| GAP-023 | - [済] | スタブ/本番切替（章内ToDoの残存）                | 03: 「本番環境にデプロイする際は強制的にスタブとモックを排除」→「ToDo: 実装内容の詳細は別途検討」 / 03: 別節では `USE_STUB_AUTH/POSTS` のガード方針が具体化                   | **同一領域で確定度が不揃い**（ガード方針は具体だが、章として ToDo が残り読み手が迷う）。                                    | ToDo を解消し、既に具体化されている `USE_STUB_*` と `NODE_ENV` ガード（403）へ寄せて章を統合/整理する（重複排除）。                                                                          | Medium     | 立ち上げ/安全運用（誤デプロイ耐性）に直結    | `docs/03.設計書.md` の「スタブ／モック設計」から ToDo を削除し、切替の単一正（接続ポイント集約）と有効化条件（`USE_STUB_AUTH/USE_STUB_POSTS` + `NODE_ENV` ガード）を明文化。誤デプロイ耐性は「スタブ認証の運用ガード」および「投稿操作（Server Actions）の暫定ガード」参照に統一。 |
| GAP-024 | - [済] | UIレイアウトの単一正（Miro依存）                | 02/03: 「画面レイアウトは別途資料（Miro）を正」                                                                                        | `docs/01〜03` だけでは **画面構成の確定に必要な情報が不足**（実装の完了条件がブレる）。                                 | Miro の「正」対象を最小限で固定（どのボード/フレームか、画面一覧、PC/スマホの対応関係）。docs 側に参照導線（識別子/命名/スクショ方針など）を追記する。                                                                  | Medium     | 実装はできても “正解” を合わせられないリスク | 方針として Miro をレイアウトの単一正とし、**実装段階で MCP 経由で Miro に接続してレイアウト確認したうえで実装**する（`docs/03.設計書.md`「デザイン・レイアウト > 実装時の進め方」参照）。                                                                  |
| GAP-025 | - [済] | 外観（テーマ）機能のスコープ整理                   | 01: 外観変更は将来導入 / 03: ThemeProvider/next-themes、E2Eでテーマ切替に言及（「実施する場合」）                                                 | MVPの範囲として **基盤のみ/切替UIまで** の境界が曖昧。                                                    | MVPでの対応範囲（基盤のみ or UIまで）を 01/02 に明記し、03 のテスト記述もそれに合わせて整合させる。                                                                                          | Low〜Medium | 手戻りは小さいが、作業計画/DoDと紐づく    | `docs/03.設計書.md` から「`next-themes` を jest mock して `setTheme(system/light/dark)` 呼び出しをユニットテストで担保する」記述を削除し、外観（テーマ）切替に関する仕様/設計/テストは実装時に改めて作成する方針に寄せた。 |

