---
title: 60. ごみ箱（設計書V2）
source:
author:
  -
published:
created: 2026-01-30
description:
tags:
---

本ファイルは設計書V1（アーカイブ済み）から、ごみ箱に関する章を分割したもの。

## この章で決めること

- ごみ箱の一覧条件（`status=trashed`）と並び順（`trashedAt`、安定ソート）
- ごみ箱内操作（復元/完全削除/空にする）と UI のルール（選択状態など）
- 通常一覧キャッシュとの関係（ごみ箱表示中も通常のキャッシュは保持）

## この章の守備範囲

- ごみ箱ビューのUI/操作と、一覧条件（`status=trashed`）を扱う
- URLスキーム/正規化は扱わない（URL章を参照）

## 関連ドキュメント（参照先）

- URL/状態管理（view=trash の扱い）: `docs/03.v2/10_URL-状態管理.md`
- 取得/キャッシュ（ごみ箱のqueryKey等）: `docs/03.v2/50_取得-キャッシュ-ページング.md`
- 文言: `docs/06. テキスト・コンテンツ定義.md`

# ごみ箱

## ごみ箱の基本設計

- ごみ箱には status: trashed の値を持つ投稿を表示する
- ごみ箱一覧は `trashedAt` 降順に表示する（同一 `trashedAt` の安定ソート: `postId` 降順）
- ごみ箱表示画面では、通常の投稿一覧と同じレイアウトの一覧コンポーネントを利用する
- ごみ箱内一覧を表示していても、通常の投稿一覧のキャッシュ状態は保持する（元の一覧画面に戻ったときに状態を復元できる）

## ごみ箱内の各投稿の要素

	    - 選択用チェックボックス
	        - チェック状態に応じてラベルを「n件選択中」に更新する
	        - この n は「ロード済みの一覧のうち、ユーザーがチェックした件数」を表示する（未ロード分は含めない）
	    - 復元ボタン
	        - 押下で status を active に変更し、ごみ箱一覧からは非表示にする
	        - 成功した投稿はチェック状態（選択数）からも除去する
	    - 削除ボタン
	        - 押下でその投稿を完全削除し、「投稿を削除しました」トーストを表示する
	        - DB: Post を物理削除し、PostTag は連動削除（Tag は削除しない）
	        - 成功した投稿はチェック状態（選択数）からも除去する
		- タグ・お気に入りの検索UIは非表示

## ごみ箱一覧上部のインターフェース

- ごみ箱一覧の上部に以下のインターフェースを配置する
		    - ヘッダー: 「通常に戻る」（`view=trash` を解除して通常ビューへ戻る）
		    - 「表示されている投稿を選択」チェックボックス
		        - チェックを入れると、現在表示されている投稿すべてにチェックを付ける
		        - 無限スクロールで追加ロードされた投稿は自動でチェックしない（追加ロード分は未チェックのまま）
		        - チェック状態ではラベルを「n件選択中」のように切り替える
	        - チェック状態のときのみ「選択した投稿を削除」ボタンを表示する
	    - 「選択した投稿を削除」ボタン
	        - 押下で削除確認モーダルを開く
	        - モーダルで確認メッセージを表示する（文言は `docs/06.テキスト・コンテンツ定義.md`「削除確認モーダル」を参照）
	          - n=チェック数（ロード済みの一覧のうち、ユーザーがチェックした件数）
	    - 「ごみ箱を空にする」ボタン
	        - 押下で削除確認モーダルを開く
	        - モーダルで確認メッセージを表示する（文言は `docs/06.テキスト・コンテンツ定義.md`「削除確認モーダル」を参照）
	        - 対象はロード済み／未ロードを問わず、status が trashed の投稿すべてとする
- `view=trash` を抜ける/入るタイミングで、チェック状態（選択数）はリセットする（誤操作防止）
- 削除確認モーダル
	    - 確認メッセージ（文言は `docs/06.テキスト・コンテンツ定義.md`「削除確認モーダル」を参照）
	    - 警告メッセージ（文言は `docs/06.テキスト・コンテンツ定義.md`「削除確認モーダル」を参照）
	    - キャンセルボタン：モーダルを閉じる
- 削除ボタン：対象の投稿を完全に削除し、「投稿を削除しました」トーストを表示する

---
