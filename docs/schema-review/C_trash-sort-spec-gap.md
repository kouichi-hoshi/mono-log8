---
status: resolved
resolved_at: 2026-01-18
summary: >
  ゴミ箱のデフォルト並び順は deletedAt とし、設計書と実装が一致しているため解消。
---

# C. ゴミ箱の並び順：設計書と実装の差分メモ

## 背景

設計書では `deletedAt` を以下の目的で導入している。

- ゴミ箱投入日時（復元で `null` に戻す）
- ゴミ箱一覧の並び替えにも使用

一方、現状の実装は一覧の `sortBy` として `updatedAt` / `createdAt` のみをサポートしている。

## 差分（仕様ギャップ）

- **設計書**: ゴミ箱の並び順に `deletedAt` を使うことを示唆
- **実装**: ゴミ箱ビューも通常ビューと同様に `updatedAt|createdAt` でソートしている

このため、ユーザー体験として「ゴミ箱に入れた順（新しい順）」を期待している場合、直感とズレる可能性がある。

## 影響範囲

- UI/操作感
  - ゴミ箱に入れた直後の投稿が一覧の上に来ない可能性
- ページング
  - ゴミ箱一覧を `deletedAt` でソートする場合、cursorページング時の安定性（同値の扱い）も要検討
- インデックス
  - `deletedAt` を `orderBy` に使うなら、対応するインデックス（例: `authorId,status,deletedAt,postId`）が欲しくなる

## 判断のための問い

- ゴミ箱の並び順は何が正か？
  - **削除日時（deletedAt）順**が正しい: 「捨てた順」に見える
  - **更新日時（updatedAt）順**が正しい: 「最後に触った順」を維持する
  - **投稿日時（createdAt）順**が正しい: 「作った順」を維持する

## 対応方針（例）

- **決定**: ゴミ箱は `deletedAt` 降順をデフォルトにする（捨てた順）
- 通常一覧は引き続き `updatedAt` をデフォルトにする（要件の「更新日時降順」）

## 次アクション

- 要件定義/設計の「ゴミ箱一覧の期待する並び順」を確定する
- 確定した並び順に合わせて、`sortBy` の選択肢（`deletedAt` を追加するか）を決める
- `deletedAt` を採用するなら、クエリ・インデックス・テスト方針も合わせて更新する
