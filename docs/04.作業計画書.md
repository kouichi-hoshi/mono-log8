---
title: 04. 作業計画書
source:
author:
  -
published:
created: 2026-01-31
description: docs/ 配下の仕様・設計を元に、実装タスクを0.5〜2日粒度で分解した作業計画表
tags:
---

# 作業計画書（設計書V2準拠）

## 参照元（入口）

- 要件: `docs/01.要件定義書.md`
- 仕様: `docs/02.仕様書.md`
- 設計（索引）: `docs/03.設計書.v2.md`
- 設計（分割）: `docs/03.v2/*`
- UI文言: `docs/05.テキスト・コンテンツ定義.md`
- 見た目（レイアウト/ワイヤー）: Miro（MCP経由。ボードIDのハードコード禁止）

## 実装フェーズ（方針）

- フェーズ1（開発効率優先）: スタブ認証・スタブCRUDで UI/ロジックを先に完成させる（TDD）
- フェーズ2（本番接続）: Auth.js（Google OAuth） + Prisma + PostgreSQL（Neon）へ差し替え、結合/E2Eで担保する
- 重要: スタブの有効/無効判定はドメインごとに接続ポイントへ集約し、`NODE_ENV=test/production` ではスタブ無効

---

## 作業計画表

|  項番 | チェックリスト（未/済） | 実装内容のタイトル                     | 実装内容                                                                                                                                   | 進捗情報                         |
| --: | :----------: | ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------- |
|   1 |      未       | 実装スコープ確定（MVP）                 | `docs/01`/`docs/02`/`docs/03.v2` を前提に、MVPで「やらないこと（将来機能）」も含めて実装対象を確定する（タグ/お気に入り/ごみ箱/キャッシュ/エラー通知/PWA）                                    | 未着手                          |
|   2 |      未       | UIレイアウト参照準備（Miro）             | `docs/03.v2/03_UI基盤.md` に従い、MCP経由でMiroの該当フレームを参照できる状態にし、画面/コンポーネント単位の参照先フレームを一覧化する                                                     | 保留(理由: Miroフレーム参照待ち)         |
|   3 |      未       | テキスト定義の利用方針を確定                | `docs/05.テキスト・コンテンツ定義.md` を正として、Alert/Toast/ボタンラベル等をコード上で一元参照できる形（定数/辞書）にする方針と置き場所を決める                                                 | 未着手                          |
|   4 |      未       | テスト基盤の確認・最小整備                 | `docs/03.v2/01_基盤-方針.md`/`docs/03.v2/90_品質-セキュリティ-テスト.md` に従い、Jest/RTL の実行・設定・最小のスモークテスト（Toaster等）を整備する                                | 未着手                          |
|   5 |      未       | 接続ポイント方針の雛形作成                 | スタブ/本物の切替を「ドメインごとに1つの接続ポイント」に集約するため、`authAdapter` / `postRepository` のI/Fとディレクトリ構成を決める（アプリコードからAuth.js/Prismaを直接呼ばない）                  | 未着手                          |
|   6 |      未       | URL正規化（canonical化）基盤          | `docs/03.v2/10_URL-状態管理.md` に従い、`mode/view/tags/favorite` の正規化関数・適用箇所（`mono-log/app/page.tsx` のredirect）・未ログイン時のクエリ全削除を実装する（先にユニットテスト） | 未着手                          |
|   7 |      未       | URL更新ユーティリティ整備                | `mergeSearchParams()` 等のURL更新規約（重複排除/ソート/削除）を実装し、UIがstateを持たずURL更新だけ行う形にする（先にユニットテスト）                                                  | 未着手                          |
|   8 |      未       | UI基盤（shadcn/tailwind/Toaster） | `docs/03.v2/03_UI基盤.md` を基に、shadcn/ui（Dialog/Popover/Alert/Sonner/Skeleton等）と共通レイアウトの土台を整備する（見た目詳細はMiroに追従）                            | 未着手                          |
|   9 |      未       | 認証：接続ポイント（authAdapter）        | `docs/03.v2/20_認証-認可-スタブ.md` に従い、ログイン/ログアウト/セッション取得を `authAdapter` 経由に集約し、UI/Server側の参照点を固定する（先にユニットテスト）                               | 未着手                          |
|  10 |      未       | 認証：スタブ認証（開発専用）                | `USE_STUB_AUTH` と `NODE_ENV` ガードを実装し、開発時のみ `/api/auth/stub` 等で簡易ログインできるようにする（`NODE_ENV=test/production` では必ず403）                       | 未着手                          |
|  11 |      未       | ログインUI（モーダル）                  | `docs/02.仕様書.md` を基に、未ログイン時のウェルカム+ログイン導線、ログインモーダル、失敗/キャンセル時のトースト、成功時の画面切替を実装する（先にUIテスト）                                                | 未着手                          |
|  12 |      未       | ログアウトUI（Popover）              | `docs/02.仕様書.md`/`docs/03.v2/20_認証-認可-スタブ.md` を基に、ユーザーアイコンPopoverの開閉、ログアウト成功時のURL全削除・キャッシュ破棄、失敗時トーストを実装する（先にUIテスト）                     | 未着手                          |
|  13 |      未       | 投稿：接続ポイント（postRepository）     | `docs/03.v2/20` の認可方針に従い、すべての操作が `authorId=session.user.id` でスコープされるI/Fを定義し、アプリ側の呼び出しを集約する（先にユニットテスト）                                  | 未着手                          |
|  14 |      未       | 投稿：スタブCRUD（開発専用）              | `USE_STUB_POSTS` と `NODE_ENV` ガードを実装し、開発時のみスタブデータで一覧/作成/更新/ごみ箱/復元/削除が動くようにする（本番/CIは必ず無効）                                               | 未着手                          |
|  15 |      未       | 投稿本文形式（content/contentText）   | `docs/03.v2/30_投稿-編集-本文形式.md` を基に、tiptap JSONを正とする保存形式、`contentText` のサーバー側生成（抽出/正規化）を実装する（先にユニットテスト）                                  | 未着手                          |
|  16 |      未       | 投稿エディタ（新規：memo/note）          | `docs/03.v2/30` を基に、`mode=memo` のinput、`mode=note` のtiptap、保存ボタン、成功時クリア/フォーカス戻し、バリデーション（422はAlert）を実装する（先にUIテスト）                       | 未着手                          |
|  17 |      未       | ノート拡大/縮小（新規のみ）                | `docs/03.v2/30` の `expanded/docked` を実装し、同一インスタンス維持・scroll lock・Escで縮小を担保する（先にUIテスト）                                                   | 未着手                          |
|  18 |      未       | 投稿一覧（表示要素）                    | `docs/03.v2/50_取得-キャッシュ-ページング.md` を基に、投稿カードの表示要素（モード/作成日時/タグ/スター/本文プレビュー）を実装する（日時はdayjs `YYYY-MM-DD HH:mm`）                            | 未着手                          |
|  19 |      未       | 編集UI（既存：memoインライン）            | `docs/03.v2/30` を基に、メモのインライン編集（更新/キャンセル、更新成功で編集解除、キャンセル時はhasEdits判定）を実装する（先にUIテスト）                                                     | 未着手                          |
|  20 |      未       | 編集UI（既存：noteモーダル/Sheet）       | `docs/03.v2/30` を基に、ノート編集のモーダル（EditorFrame共通化）、背景の新規エディタのロック、閉じる/保存/hasEdits判定を実装する（先にUIテスト）                                           | 未着手                          |
|  21 |      未       | 離脱ガード（hasEdits）               | `docs/03.v2/30`/`docs/02.仕様書.md` を基に、URL変更操作・編集切替・モーダルクローズ・ブラウザ離脱で確認を出し、「破棄して続行/編集を続ける」を実装する（先にユニット/結合テスト）                             | 未着手                          |
|  22 |      未       | タグ：正規化/バリデーション                | `docs/03.v2/40_タグ-お気に入り.md` を基に `normalizeTagLabel`（NFKC/制御文字除去/空白圧縮/1行化）とバリデーション（空/32文字）を実装する（先にユニットテスト）                              | 未着手                          |
|  23 |      未       | タグ編集UI（投稿エディタ内）               | `docs/03.v2/40` を基に、タグアコーディオン、サジェスト、チップ表示/削除、新規タグは保存/更新時に作成して反映、上限10件（422はAlert）を実装する（先にUIテスト）                                         | 未着手                          |
|  24 |      未       | お気に入り（スター）操作                  | `docs/03.v2/50`/`docs/03.v2/40` を基に、通常ビューのみスターON/OFF、URLのfavorite絞り込みとの整合、連打防止（Mutation isPendingでdisabled）を実装する（先にUIテスト）              | 未着手                          |
|  25 |      未       | 投稿検索UI（filters/解除）            | `docs/03.v2/50`/`docs/03.v2/10` を基に、TagFilter/FavoriteFilter/ClearFilters を実装し、URL反映（tagsは複数&ソート&重複排除、favoriteは1に正規化）を担保する（先にUIテスト）    | 未着手                          |
|  26 |      未       | 取得・キャッシュ基盤（TanStack Query）    | `docs/03.v2/50` を基に、queryKey設計（posts/posts-filter）と「通常/ごみ箱はキャッシュ、絞り込みは非キャッシュ」を実装する（先にユニットテスト）                                          | 未着手                          |
|  27 |      未       | 無限スクロール（cursor + Skeleton）    | `docs/03.v2/50` を基に、`useInfiniteQuery` + IntersectionObserver による追加取得、初回/追加のSkeleton、失敗時の状態維持+再試行導線を実装する（先にUIテスト）                      | 未着手                          |
|  28 |      未       | スクロール位置の保存/復元                 | `docs/03.v2/50` の方針に従い、「表示中の一覧条件」単位でスクロール位置を保存し、キャッシュ復元時に可能な範囲で復元する（先にユニットテスト）                                                         | 未着手                          |
|  29 |      未       | ごみ箱ビュー切替（view=trash）          | `docs/03.v2/10_URL-状態管理.md`/`docs/03.v2/60_ごみ箱.md` を基に、`view=trash` 時のUI（モード切替/filters非表示、effective filters固定）と通常への復帰を実装する             | 未着手                          |
|  30 |      未       | ごみ箱：単体操作（復元/完全削除）             | `docs/03.v2/60` を基に、投稿カードのチェックボックス/復元/削除、成功時トースト、選択状態からの除去、連打防止を実装する（先にUIテスト）                                                          | 未着手                          |
|  31 |      未       | ごみ箱：一括操作（選択削除/空にする）           | `docs/03.v2/60`/`docs/05.テキスト・コンテンツ定義.md` を基に、全選択/選択数表示/確認モーダル/選択削除/全削除（空にする）を実装し、view出入りで選択状態リセットを担保する（先にUIテスト）                       | 未着手                          |
|  32 |      未       | エラー/通知（Alert/Toast）共通化        | `docs/03.v2/70_エラー-通知.md` を基に、401/403/404/422/5xx 等の分類→UI挙動（状態維持、ログインモーダル自動表示等）を共通化する（先にユニットテスト）                                       | 未着手                          |
|  33 |      未       | 開発用エラーシミュレーション                | `docs/03.v2/70` を基に、`errorTest` クエリでsonner通知を出し、表示後にパラメータ削除、`NODE_ENV=production` で無効化を実装する（先にユニットテスト）                                 | 未着手                          |
|  34 |      未       | PWA/manifest + icons          | `docs/03.v2/02_設定-環境変数-PWA.md` を基に、manifest（Metadata Route含む）/`mono-log/public/icons/*`/`display=standalone`/theme_color等を実装する（値は暫定）   | 未着手                          |
|  35 |      未       | セキュリティ（XSS最小対策）               | `docs/03.v2/90_品質-セキュリティ-テスト.md` を基に、tiptap read-only表示（`dangerouslySetInnerHTML` 回避）、リンク許可プロトコル制限、内部情報非表示の方針を実装で担保する（先にテスト）           | 未着手                          |
|  36 |      未       | 本物接続：Auth.js（Google OAuth）    | `docs/03.v2/20_認証-認可-スタブ.md` を基に、Auth.js v5 + Google Provider を実装し、スタブ認証を削除できる状態まで到達する（結合/E2Eで確認）                                      | 未着手                          |
|  37 |      未       | 本物接続：Prisma/DBモデル実装           | `docs/03.v2/80_DBモデル.md` のUser/Post/Tag/PostTagとインデックスをPrismaに反映する（migration作成/適用は手順確認のうえ別途実施）                                         | 未着手                          |
|  38 |      未       | 本物接続：Repository（Prisma実装）     | `docs/03.v2/20` の認可方針に従い、`postRepository` をPrisma実装へ差し替える（findMany cursor/trashedAt、タグ解決、favorite等）                                    | 未着手                          |
|  39 |      未       | 結合テスト（DBあり・スタブ無効）             | `docs/03.v2/90` に従い、`NODE_ENV=test` でスタブ無効のまま、Server Actions + Prisma + PostgreSQL を通す結合テストを整備する（テストDB準備手順は要補完）                        | 保留(理由: テストDB/CI手順のドキュメント不足)  |
|  40 |      未       | E2Eテスト（Playwright）            | `docs/03.v2/90` の方針に従い、stg（検証用Neon）でログイン〜投稿作成/編集/ごみ箱/絞り込み/無限スクロールの回帰を自動化する                                                             | 保留(理由: stg環境/テストアカウント運用設計待ち) |
|  41 |      未       | 運用手順（CI・デプロイ）ドキュメント補完         | `docs/03.v2/80_DBモデル.md` が参照する `docs/07...` 相当を追加し、CIでの環境変数/DB/スタブ無効化、stg/prodの運用を定義する                                                 | 保留(理由: 対応ドキュメント未作成)          |
